{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Модель скользящего среднего MA()", "text": "Модель скользящего среднего порядкаили просто MA() предполагает следующую зависимость данных: где— стационарный ряд со средним, а— гауссовский белый шум, то естьи независимы. По сути наш рядвыражается через сумму некоторого фиксированного среднего, значения белого шума в текущий момент времении не болеепредыдущих значений белого шума, домноженных на некоторые коэффициенты, которые являются параметрами модели. Рассмотрим некоторые свойства модели MA(). Как уже было упомянуто выше, рядбудет являтьcя стационарным со средним. Найдем также. Воспользовавшись свойством независимости для, можем заключить, что Посчитаем автоковариационную функцию для ряда, то есть найдем значение. Легко понять, что если, то= 0, т.к.независимы. Если же, то тогда Записав более компактно, можем получить: где. Из посчитанных значений для дисперсии и ковариационной функции, можете попробовать получить выражение и для автокорреляционной функции. Ее особенностью будет как раз равенство нулю на лаге, превосходящим. Посмотрим на визуализацию:", "useful_links": []}
{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Модель авторегрессии AR()", "text": "Модель авторегрессии для временного ряда можно записать следующим образом: где— стационарный ряд, а— гауссовский белый шум, то естьи независимы. Отметим, что, вообще говоря, для стационарности нужны некоторые условия на коэффициенты. По сути наш рядвыражается через сумму некоторого фиксированного числа, значения белого шума в текущий момент времении не болеепредыдущих значений этого же ряда, домноженных на некоторые коэффициенты, которые являются параметрами модели. Другими словами, модель AR() — это модельдля которой Таргет:— значение ряда в момент времени Признаки:— значения ряда в предыдущие моменты времени Введем— оператор сдвига, обладающий следующими свойствами: применениек ряду дает предыдущее значение этого же ряда: применениек белому шуму дает предыдущее значение шума: применениек константе — это константа: Операториногда называют такжелаговымоператором. Можно рассматривать функции от оператора сдвига, например, кратное применение оператора:или. Для записей некоторых моделей временных рядов будет удобно использовать лаговый многочлен: Обратным к операторуназывают оператортакой, что: Так, например, дляможно заключить, что: Рассмотрим модель AR(): С помощью оператора сдвига ее можно представить в следующем виде: где— характеристический полином. Сформулируем пару важных утверждений: Любой стационарный (в широком смысле) процесс представим в виде, то есть в виде модели скользящего среднего с неограниченным количеством слагаемых (конечное или бесконечное число). Этот результат так же известен кактеорема Волдао декомпозиции временного ряда. Модельзадает стационарный временной рядвсе комплексные корнилежат вне единичного круга. Приведем пояснение второго утверждения. В самом деле, пусть— все его комплексные корни (их ровнос учетом кратности), тогда справедливо представление: Тогда при представлении временного ряда в виде и дальнейшего его разложения на простые дроби возникнут слагаемые вида Если при этомлежит внутри единичного круга или на его границе, то соответствующий ряд будет расходящимся. На самом деле, случаймы в дальнейшем учтем. В качестве примера рассмотрим подробнее модель.Зависимость имеет вид, где. Для данного ряда можно выписать следующие свойства: Уравнение, имеет корень. Тем самым,стационарен. Кроме того, чем меньше, тем предыдущее значение ряда вносит меньший вклад в текущее значение. Если ряд стационарен, то:. . Разберем первое равенство, остальные получаются аналогично. Возьмем математическое ожидание в уравнении ряда Поскольку ряд стационарен, то его математическое ожидание не меняется во времени, а для белого шума математическое ожидание равно нулю. Тем самым мы получаем уравнение на, откуда следует доказываемая формула. Таким образом, в зависимости от значениямы можем получить следующие результаты: Если, то— представление ряда в виде MA(). Если, то— это случайное блуждание. Если, то— экспоненциально растущий процесс. Посмотрим на визуализацию. В первом случае мы имеем модель, отрицательный коэффициент является следствием больших колебаний ряда. Во втором случае модель, большой положительный коэффициент делает ряд менее шумным. В третьем случае показано несколько рядов вида случайного блуждания, что соответствует случаю. В четвертом случае показан экспоненциальный процесс, на графике шум уже не заметен из-за масштаба. На немного вернемся к модели MA(). Чуть выше мы выяснили, что при некоторых условиях на коэффицентывременной ряд модели AR() будет стационарным, а значит имеет представление в виде MA(). На самом деле, модель скользящего среднего порядкатоже можно представить с помощью оператораследующим образом: где—характеристический многочлен. Для простоты изложения пусть. Важным при такой записи оказывается понятие обратимости, то есть представления в виде которое означает, что ряд можно представить в виде бесконечной авторегрессионной модели.Здесь, как и в рассуждениях выше, можно заключить, что временной рядобратим, если все комплексные корнилежат вне единичного круга.", "useful_links": []}
{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Модель ARMA()", "text": "Модель ARMA() по сути является суммой моделейи, иначе говоря, модель есть сумма нескольких предыдущих значений ряда и нескольких предыдущих значений белого шума с некоторым коэффициентами. Эквивалентную запись ряда в терминах оператора сдвига можно получить, рассмотрев два многочлена или гдеи.Заметим, что во втором представлении константазаменена на. На самом деле, стационарность такого ряда будет определяться только его AR() компонентой, то есть значениями коэффициентов, так ряд в модели MA() всегда является стационарным.", "useful_links": []}
{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Модель ARIMA()", "text": "Модель ARIMA() — это расширение моделей типа ARMA на нестационарные временные ряды, которые однако могут стать стационарным после применениея процедуры дифференцирования ряда. Модель ARIMA() для рядаопределяется как модель ARMA() для ряда разностей порядкаряда. Разность порядка 1:. Разность порядка 2:. Получаем формулу модели ARIMA: или То есть многочленимеетединичных корней.Тем самым такая модель позволяет учесть нестационарности, в частности, тренд. В качестве примера рассмотрим процесс случайного блуждания: где— белый шум. Как уже упомяналось ранее, такой ряд не является стационарным. Однако, если мы применим операцию дифференцирования, то можем перейти к новому, уже стационарном ряду, который можно записать в виде:", "useful_links": []}
{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Частичная автокорреляция", "text": "Для модели скользящего среднего порядкамы выяснили, что значения автокорреляционной функции для такого ряда оказывается равной нулю после лага. Эта особенность позволяет использовать автокорреляционную функцию для определения порядка модели скользящего среднего. Возникает разумный вопрос, как оценить порядокдля модели AR()? Здесь оказывается полезным понятие частичной (частной) автокорреляционной функции. Частичная автокорреляция (PACF)— корреляция ряда с собой после снятия линеной зависимости от промежуточных значений ряда. Иначе говоря, мы хотим как-то учесть опосредованного влияние промежуточных значений ряда и оценить непосредственное влияниена. Чуть более формально частичную автокорреляцию можно записать следующим образом: где— линейная регрессия на: Пример для: где— МНК-оценка в модели. Можно показать, что значение частиной автокорреляции для модели авторегресии AR() будет ненулевой для лагови равняться нулю для лагов. Имеет место быть полная аналогия с автокорреляционной функцией и моделью MA(). Таким образом, исследование поведения автокорреляционной и частичной автокорреляционной функции может быть использовано для определения порядкамодели скользящего среднего и порядкамодели авторегрессии соответсвтенно.", "useful_links": []}
{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Оценка коэффициентов в ARIMA", "text": "Пусть гиперпараметрыфиксированы.&tab;В предположении, что— гауссовский белый шум, в нашей модели мы можем выписать функцию правдоподобиягде— соместная плотность. Из-за того, чтоимеют нормальное распределение, она будет иметь разумный вид. Соответственно, в качестве оценок параметров берется оценка максимального правдоподобия. Для поиска начальных приближение для параметровивоспользуемся автокорреляционной и частичной автокорреляционной функцией. Начальное приближение: последний значимый пик у PACF. Начальное приближение: последний значимый пик у ACF. Далее обычно используется поиск по сетке вокруг подобранных значений, минимизируя информационный критерий: — критерий Акаике; — критерий Акаике (короткие ряды); — Байесовский информационный критерий или критерий Шварца, где— логарифм функции правдоподобия,— длина временного ряда. Приведем некоторый план при применению модели ARIMA для прогнозирования временных рядов. Анализ выбросов: замена нерелевантых выбросов наNAили усреднение по соседним элементам. Стабилизация дисперсии (преобразования). Дифференцирование, если ряд не стационарен. Выбор пилотныхипо PACF и ACF. Вокруг этих параметров подбираем оптим. модель по/. Пошаговое построение прогноза:— для:;— для:;— для:. Построение предсказательного интервала:— если остатки модели нормальны и гомоскедастичны (дисперсия постоянна), то строится теоретический предсказательный интервалгде— горизонт прогнозирования,— оценка на дисперсию шума,— коэф. для ряда при его представлении в виде бесконечного процесса скользящего среднего. И, имогут быть выражены через оценки на параметрыи.— иначе интервалы строятся с помощью бутстрепа.", "useful_links": []}
{"document_title": "Модели вида ARIMA", "url": "https://education.yandex.ru/handbook/ml/article/modeli-vida-arima", "section_title": "Модели SARIMA и ARIMAX", "text": "Рассмотрим некоторые расширение модели ARIMA. Обобщение модели ARIMA на ряды с наличием сезонной составляющей назвается SARIMA. Пусть— известная сезонность ряда. Добавим в модель ARIMA() компоненты, отвечающие за значения в предыдущие сезоны. Тогда модель SARIMAможет быть записана следующим образом: где Параметр сезонного дифференцирования, а также параметрыподбираются из тех же соображений, что и для, но только с поправкой, что делается это с учетом сезонности. ARIMAX — обобщение модели ARIMA, которая учитывает некоторые экзогенные факторы. Пусть— ряд регрессоров,известный до начала прогноза. Простой вариант: Общий случай: Пример: Вышеуказанные модели можно объединить и получить SARIMAX: Проведем аналогию с линейной регрессией. Это линейная по признакам модель, в которой Отклик:— значение ряда в моменты времени Признаки:— значения ряда в предыдущие моменты времениЗначение ряда за предыдущие сезоныЗначения признаков в предыдущие моменты времениЗначения признаков в предыдущие сезоны — значения ряда в предыдущие моменты времени Значение ряда за предыдущие сезоны Значения признаков в предыдущие моменты времени Значения признаков в предыдущие сезоны Ошибка:сумма шума за предыдущие моменты времени и предыдущие сезоны.", "useful_links": []}
